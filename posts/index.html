<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>posts - David C</title>
    <link rel="stylesheet" href="/assets/stylesheets/normalize.css">
    <link rel="stylesheet" href="https://unpkg.com/sakura.css/css/sakura.css" type="text/css">
    <link rel="stylesheet" href="/assets/stylesheets/default.css">
  </head>
  <body>
    <!-- <div class="wrapper"> -->
      <aside class="top">
        <!-- <div class="top-content"> -->
          <a href="/">
            <header>
                
                <img src="https://secure.gravatar.com/avatar/7083d161b041964b75c38376d9dee37a?s=200" class="profile-pic" />
                
                <span class="name">
                  David Charte
                </span>
            </header>
          </a>
          <!--nav class="sections">
              <a href="/" class="section-link">about</a>
              <a href="/blog" class="section-link">blog</a>
          </nav-->
          <div class="arrow-up"></div>
        <!-- </div> -->
      </aside>
      <!-- <div class="main"> -->
        <!-- <div class="main-content"> -->
          
  <article>
    <a href="https://libreim.github.io/blog/2014/06/24/introduccion-javascript/"><h1>Introducción a JavaScript. Programación con prototipos</h1></a>
    

  </article>

  <article>
    <a href="https://libreim.github.io/blog/2015/08/24/ruby-enumerators/"><h1>Iterating in Ruby: Enumerable and Enumerators</h1></a>
    

  </article>

  <article>
    <a href="/research/2016/06/01/multilabel/"><h1>Multilabel classification</h1></a>
    <p>Multilabel classification is a variant of the classification problem where each instance can be associated with a subset of labels from the set of available ones.</p>

<p>Published works:</p>

<ul>
  <li><em>Tips, guidelines and tools for managing multi-label datasets: The mldr.datasets R package and the Cometa data repository</em>. F. Charte, A. Rivera, D. Charte, M J. del Jesus, F. Herrera. (Neurocomputing, 2018) <a href="https://www.sciencedirect.com/science/article/pii/S0925231218301401">ScienceDirect</a>, <a href="https://arxiv.org/abs/1802.03568">arXiv</a></li>
  <li><em><a href="http://link.springer.com/chapter/10.1007/978-3-319-32034-2_41">R Ultimate Multilabel Dataset Repository</a></em>. F. Charte, D. Charte, A. Rivera, M. J. del Jesus, F. Herrera. (HAIS 2016)</li>
  <li><em><a href="http://simd.albacete.org/actascaepia15/papers/00695.pdf">mldr: Paquete R para Exploración de Datos Multietiqueta</a></em>. D. Charte, F. Charte. (TAMIDA - CAEPIA, 2015)</li>
  <li><em><a href="https://journal.r-project.org/archive/2015-2/charte-charte.pdf">Working with Multilabel Datasets in R: the mldr Package</a></em>. F. Charte, D. Charte. (The R Journal, 2015)</li>
</ul>

<p>Associated software:</p>

<ul>
  <li><a href="https://github.com/fcharte/mldr">mldr</a>, an R package for exploratory data analysis and manipulation of multilabel datasets</li>
  <li><a href="https://github.com/fcharte/mldr.datasets/">mldr.datasets</a>, the R package associated to the Ultimate Multilabel Dataset Repository</li>
</ul>

  </article>

  <article>
    <a href="/blog/2016/08/22/jekyll-formularios/"><h1>Un sistema de contribuciones a blogs Jekyll para gente sin conocimientos de Jekyll, GitHub o Markdown</h1></a>
    <p>Durante un tiempo, los colaboradores del <a href="http://tux.ugr.es/dgiim/blog">blog de LibreIM</a> hemos tenido que componer los posts prácticamente a mano, haciendo uso de un editor de texto para escribirlos, Git para llevar el registro de cambios y una <em>pull request</em> en GitHub para enviar el post, revisarlo y corregirlo. Evidentemente, este puede ser un proceso ideal para desarrolladores acostumbrados al proceso, pero está lejos de ser perfecto cuando tratamos de mantener un blog colaborativo abierto a que cualquiera publique su conocimiento. Lo que buscamos es una forma de abstraer el proceso de edición y envío de posts para hacer el blog accesible a mucha más gente.</p>

<p>La solución que concebimos consta de dos partes: por un lado, un backend que utilizaría una cuenta <em>bot</em> de GitHub para la gestión automática de ramas y <em>pull requests</em>; por otro, una aplicación web con un formulario y un sencillo editor desde la que se enviarían los posts.</p>

<p class="fig"><img src="/assets/images/jekyll-form.png" alt="Formulario resultante" />
Un ejemplo del <a href="http://tux.ugr.es/dgiim/new/post">formulario resultante</a></p>

<h2 id="preparativos-previos">Preparativos previos</h2>

<p>Para crear nuevos <em>commits</em> y <em>pull requests</em> necesitamos una cuenta de GitHub. Podemos usar la propia o crear una nueva. Otorgaremos a dicha cuenta permisos de escritura sobre el repositorio de blog en cuestión. Después, obtendremos un <a href="https://github.com/settings/tokens">token de acceso personal</a> con permisos de modificación de repositorios. Dicho token lo almacenaremos en las variables de entorno de la shell donde vayamos a hospedar la aplicación, supongamos que bajo el nombre de <code class="language-plaintext highlighter-rouge">GITHUB_TOKEN</code>.</p>

<h2 id="el-backend">El backend</h2>

<p>Componer un guion que trabaje con Git automáticamente no es muy complicado. Se podría utilizar directamente un guion de Bash pero, en vistas a integrarlo en la aplicación web, usamos la <a href="https://rubygems.org/gems/git">gema git</a> para Ruby. Esta permite realizar todo tipo de operaciones sobre repositorios Git, a nosotros nos basta con clonar, abrir una nueva rama, incluir un nuevo archivo en un <em>commit</em> y enviarlo al repositorio remoto. El siguiente código Ruby define una función que realiza todo el proceso, notemos cómo se obtiene por parámetro un <em>block</em> (similar a una función anónima) que permite realizar las modificaciones pertinentes al repositorio:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># repo.rb</span>
<span class="nb">require</span> <span class="s1">'fileutils'</span>
<span class="nb">require</span> <span class="s1">'git'</span>

<span class="k">def</span> <span class="nf">modify_repo</span> <span class="n">repo</span><span class="p">,</span> <span class="n">head</span><span class="p">,</span> <span class="n">commit_msg</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">block</span>
  <span class="n">dir</span> <span class="o">=</span> <span class="s2">".repo"</span>

  <span class="c1"># Usamos el token de acceso para clonar el repositorio</span>
  <span class="n">g</span> <span class="o">=</span> <span class="no">Git</span><span class="p">.</span><span class="nf">clone</span><span class="p">(</span><span class="s2">"https://</span><span class="si">#{</span><span class="no">ENV</span><span class="p">[</span><span class="s2">"GITHUB_TOKEN"</span><span class="p">]</span><span class="si">}</span><span class="s2">@github.com/</span><span class="si">#{</span><span class="n">repo</span><span class="si">}</span><span class="s2">.git"</span><span class="p">,</span> <span class="n">dir</span><span class="p">)</span>

  <span class="c1"># Configuramos el email y nombre de la cuenta bot</span>
  <span class="n">g</span><span class="p">.</span><span class="nf">config</span><span class="p">(</span><span class="s2">"user.name"</span><span class="p">,</span> <span class="s2">"BOT"</span><span class="p">)</span>
  <span class="n">g</span><span class="p">.</span><span class="nf">config</span><span class="p">(</span><span class="s2">"user.email"</span><span class="p">,</span> <span class="s1">'BOT_EMAIL@example.org'</span><span class="p">)</span>

  <span class="c1"># Creamos una rama nueva</span>
  <span class="n">g</span><span class="p">.</span><span class="nf">branch</span><span class="p">(</span><span class="n">head</span><span class="p">).</span><span class="nf">checkout</span>

  <span class="c1"># Realizamos modificaciones en el repo</span>
  <span class="n">g</span><span class="p">.</span><span class="nf">chdir</span> <span class="p">{</span> <span class="n">block</span><span class="p">.</span><span class="nf">call</span> <span class="p">}</span>

  <span class="c1"># Commit y push</span>
  <span class="n">g</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="ss">all: </span><span class="kp">true</span><span class="p">)</span>
  <span class="n">g</span><span class="p">.</span><span class="nf">commit</span><span class="p">(</span><span class="s2">"</span><span class="si">#{</span><span class="n">commit_msg</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
  <span class="n">g</span><span class="p">.</span><span class="nf">push</span><span class="p">(</span><span class="s2">"origin"</span><span class="p">,</span> <span class="n">head</span><span class="p">)</span>

  <span class="no">FileUtils</span><span class="p">.</span><span class="nf">rm_rf</span><span class="p">(</span><span class="n">dir</span><span class="p">)</span>
<span class="k">end</span>
</code></pre></div></div>

<p>Ahora hemos de añadir la capacidad de crear <em>pull requests</em>, para ello usamos la <a href="https://rubygems.org/gems/octokit">gema octokit</a>, que acepta el token de acceso que obtuvimos antes:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># form.rb</span>
<span class="nb">require</span> <span class="s1">'octokit'</span>
<span class="nb">require_relative</span> <span class="s1">'repo'</span>

<span class="n">github</span> <span class="o">=</span> <span class="no">Octokit</span><span class="o">::</span><span class="no">Client</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="ss">:access_token</span> <span class="o">=&gt;</span> <span class="no">ENV</span><span class="p">[</span><span class="s2">"GITHUB_TOKEN"</span><span class="p">])</span>

<span class="n">repo</span> <span class="o">=</span> <span class="s2">"BOT/blog"</span>
<span class="n">base</span> <span class="o">=</span> <span class="s2">"gh-pages"</span>
<span class="n">head</span> <span class="o">=</span> <span class="s2">"new-post"</span>

<span class="n">modify_repo</span> <span class="n">repo</span><span class="p">,</span> <span class="n">head</span><span class="p">,</span> <span class="s2">"Nuevo post"</span> <span class="k">do</span>
  <span class="c1"># Creación del nuevo post</span>
<span class="k">end</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">github</span><span class="p">.</span><span class="nf">create_pull_request</span><span class="p">(</span><span class="n">repo</span><span class="p">,</span> <span class="n">base</span><span class="p">,</span> <span class="n">head</span><span class="p">,</span> <span class="s2">"Nuevo post"</span><span class="p">,</span> <span class="s2">""</span><span class="p">)</span>
</code></pre></div></div>

<p>Únicamente nos queda obtener del usuario los datos necesarios para crear un nuevo post: un titulo, un autor, una categoría y el contenido.</p>

<h2 id="el-formulario">El formulario</h2>

<h3 id="sinatra">Sinatra</h3>

<p><a href="http://www.sinatrarb.com/">Sinatra</a> es un <em>domain specific language</em> (DSL) para Ruby que facilita la creación de aplicaciones web sencillas sin apenas esfuerzo. Basta con escribir las peticiones HTTP que se aceptan y cuál es la respuesta. Además, es muy útil utilizarlo junto a otras gemas de Ruby que ahorren trabajo a la hora de escribir las plantillas y el estilo. Nuestro archivo de dependencias <code class="language-plaintext highlighter-rouge">Gemfile</code> queda de la siguiente forma:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Gemfile</span>

<span class="n">source</span> <span class="s1">'https://rubygems.org'</span>

<span class="n">gem</span> <span class="s1">'sinatra'</span>
<span class="n">gem</span> <span class="s1">'sinatra-contrib'</span>
<span class="n">gem</span> <span class="s1">'thin'</span>      <span class="c1"># Web server</span>
<span class="n">gem</span> <span class="s1">'haml'</span>      <span class="c1"># For layouts</span>
<span class="n">gem</span> <span class="s1">'sass'</span>      <span class="c1"># For stylesheets</span>
<span class="n">gem</span> <span class="s1">'kramdown'</span>  <span class="c1"># For the preview</span>
<span class="n">gem</span> <span class="s1">'rouge'</span>     <span class="c1"># For syntax highlighting</span>
<span class="n">gem</span> <span class="s1">'octokit'</span>   <span class="c1"># For pull requests</span>
<span class="n">gem</span> <span class="s1">'git'</span>       <span class="c1"># Repo management</span>
<span class="n">gem</span> <span class="s1">'recaptcha'</span> <span class="c1"># Some protection against bots</span>
</code></pre></div></div>

<p>Para instalar y manejar las dependencias usamos <a href="http://bundler.io/">Bundler</a>: basta así con ejecutar <code class="language-plaintext highlighter-rouge">gem install bundler</code> y tras esto <code class="language-plaintext highlighter-rouge">bundle install</code>.</p>

<h3 id="respondiendo-a-peticiones">Respondiendo a peticiones</h3>

<p>Vamos a ampliar el archivo <code class="language-plaintext highlighter-rouge">form.rb</code> creado anteriormente para aceptar y responder un par de peticiones HTTP. Responderemos a <code class="language-plaintext highlighter-rouge">GET /</code> mostrando el formulario, que crearemos aparte en una vista en Haml. Por otro lado, al enviar dicho formulario se creará una petición <code class="language-plaintext highlighter-rouge">POST /posts</code> con los datos que necesitamos para componer el nuevo post.</p>

<div class="language-haml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">-# views/form.haml
</span><span class="nt">%h1</span> Nuevo post
<span class="nt">%form</span><span class="p">{</span><span class="ss">action: </span><span class="s2">"/posts"</span><span class="p">,</span> <span class="ss">method: </span><span class="s2">"post"</span><span class="p">}</span>
  <span class="nt">%input</span><span class="p">{</span><span class="ss">type: </span><span class="s2">"text"</span><span class="p">,</span> <span class="ss">name: </span><span class="s2">"title"</span><span class="p">,</span> <span class="ss">placeholder: </span><span class="s2">"Título"</span><span class="p">}</span>
  <span class="nt">%input</span><span class="p">{</span><span class="ss">type: </span><span class="s2">"text"</span><span class="p">,</span> <span class="ss">name: </span><span class="s2">"author"</span><span class="p">,</span> <span class="ss">placeholder: </span><span class="s2">"Autor 1, Autor 2, ..."</span><span class="p">}</span>
  <span class="nt">%input</span><span class="p">{</span><span class="ss">type: </span><span class="s2">"text"</span><span class="p">,</span> <span class="ss">name: </span><span class="s2">"category"</span><span class="p">,</span> <span class="ss">placeholder: </span><span class="s2">"Categoría"</span><span class="p">}</span>
  <span class="nt">%textarea</span><span class="p">{</span><span class="ss">name: </span><span class="s2">"content"</span><span class="p">,</span> <span class="ss">placeholder: </span><span class="s2">"Contenido"</span><span class="p">}</span>
  <span class="nt">%input</span><span class="p">{</span><span class="ss">type: </span><span class="s2">"submit"</span><span class="p">,</span> <span class="ss">value: </span><span class="s2">"Enviar"</span><span class="p">}</span>
</code></pre></div></div>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># form.rb</span>
<span class="nb">require</span> <span class="s1">'rubygems'</span>
<span class="nb">require</span> <span class="s1">'bundler'</span>
<span class="no">Bundler</span><span class="p">.</span><span class="nf">require</span><span class="p">(</span><span class="ss">:default</span><span class="p">)</span>
<span class="nb">require_relative</span> <span class="s2">"repo"</span>

<span class="n">get</span> <span class="s2">"/"</span> <span class="k">do</span>
  <span class="c1"># Mostramos el formulario</span>
  <span class="n">haml</span> <span class="ss">:form</span>
<span class="k">end</span>

<span class="n">post</span> <span class="s2">"/posts/?"</span> <span class="k">do</span>
  <span class="c1"># Obtenemos los datos</span>
  <span class="n">title</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="ss">:title</span><span class="p">]</span>
  <span class="n">author</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="ss">:author</span><span class="p">]</span>
  <span class="n">content</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="ss">:content</span><span class="p">]</span>
  <span class="n">category</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="ss">:category</span><span class="p">]</span> <span class="o">||</span> <span class="s2">"unclassified"</span>

  <span class="c1"># Creamos el nombre del archivo</span>
  <span class="n">date</span> <span class="o">=</span> <span class="no">Date</span><span class="p">.</span><span class="nf">today</span><span class="p">.</span><span class="nf">strftime</span> <span class="s2">"%Y-%m-%d"</span>
  <span class="n">filename</span> <span class="o">=</span> <span class="n">title</span><span class="p">.</span><span class="nf">downcase</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="s2">" "</span><span class="p">)[</span><span class="mi">0</span><span class="o">..</span><span class="mi">4</span><span class="p">].</span><span class="nf">join</span><span class="p">(</span><span class="s2">"-"</span><span class="p">)</span>

  <span class="n">github</span> <span class="o">=</span> <span class="no">Octokit</span><span class="o">::</span><span class="no">Client</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="ss">:access_token</span> <span class="o">=&gt;</span> <span class="no">ENV</span><span class="p">[</span><span class="s2">"GITHUB_TOKEN"</span><span class="p">])</span>

  <span class="n">repo</span> <span class="o">=</span> <span class="s2">"BOT/blog"</span>
  <span class="n">base</span> <span class="o">=</span> <span class="s2">"gh-pages"</span>
  <span class="n">head</span> <span class="o">=</span> <span class="s2">"new-post-</span><span class="si">#{</span><span class="n">filename</span><span class="si">}</span><span class="s2">"</span>

  <span class="n">modify_repo</span> <span class="n">repo</span><span class="p">,</span> <span class="n">head</span><span class="p">,</span> <span class="s2">"Nuevo post"</span> <span class="k">do</span>
    <span class="c1"># Creamos el archivo del post</span>
    <span class="no">File</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="s2">"_posts/</span><span class="si">#{</span><span class="n">date</span><span class="si">}</span><span class="s2">-</span><span class="si">#{</span><span class="n">filename</span><span class="si">}</span><span class="s2">.md"</span><span class="p">,</span> <span class="s2">"w"</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span>
        <span class="n">f</span><span class="p">.</span><span class="nf">write</span> <span class="o">&lt;&lt;</span><span class="no">EOF</span><span class="sh">
---
layout: post
title: </span><span class="si">#{</span><span class="n">title</span><span class="si">}</span><span class="sh">
authors: </span><span class="si">#{</span><span class="n">author</span><span class="p">.</span><span class="nf">split</span> <span class="sr">/,\s*/</span><span class="si">}</span><span class="sh">
category: </span><span class="si">#{</span><span class="n">category</span><span class="si">}</span><span class="sh">
---

</span><span class="si">#{</span><span class="n">content</span><span class="si">}</span><span class="sh">
</span><span class="no">EOF</span>
    <span class="k">end</span>
  <span class="k">end</span>

  <span class="n">response</span> <span class="o">=</span> <span class="n">github</span><span class="p">.</span><span class="nf">create_pull_request</span><span class="p">(</span><span class="n">repo</span><span class="p">,</span> <span class="n">base</span><span class="p">,</span> <span class="n">head</span><span class="p">,</span> <span class="s2">"Nuevo post"</span><span class="p">,</span> <span class="s2">""</span><span class="p">)</span>
<span class="k">end</span>
</code></pre></div></div>

<p>Para iniciar el servidor web con nuestra aplicación, debería bastar con ejecutar <code class="language-plaintext highlighter-rouge">ruby form.rb</code> en el terminal.</p>

<h3 id="añadiendo-un-editor-de-verdad">Añadiendo un editor de verdad</h3>

<p>Todo esto ya está muy bien, y la aplicación ahorra un montón de esfuerzo para cada vez que se crea un nuevo post. Pero aún queda una barrera que evitaría que algunos usuarios estuvieran cómodos escribiendo: el marcado de formato con Markdown. Existen diversos editores Markdown que pueden incrustarse en una página web, algunos con amplias funcionalidades y otros más sencillos. Nosotros optamos por <a href="https://simplemde.com/">SimpleMDE</a>, que facilita la escritura mediante algunas pistas visuales en el código y unos botones que dan acceso a la mayoría de opciones de formato de Markdown.</p>

<p>Este editor aporta además una opción de previsualización personalizable, lo que quiere decir que podemos modificar la forma en que se compila el código Markdown y se muestra dicha vista previa. Como los blogs Jekyll usan el intérprete <a href="http://kramdown.gettalong.org/">Kramdown</a> por defecto, podemos añadir una ruta al servidor que compile un documento mediante esta herramienta. Además, utilizamos también la gema <a href="http://rouge.jneen.net/">Rouge</a> para resaltado de código.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># form.rb</span>
<span class="c1"># ...</span>
<span class="n">post</span> <span class="s2">"/preview/?"</span> <span class="k">do</span>
  <span class="no">Kramdown</span><span class="o">::</span><span class="no">Document</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="ss">:content</span><span class="p">],</span> <span class="ss">syntax_highlighter: :rouge</span><span class="p">).</span><span class="nf">to_html</span>
<span class="k">end</span>
</code></pre></div></div>

<p>Por otro lado, el editor habrá que inicializarlo mediante un código similar al siguiente:</p>

<div class="language-haml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">%form</span><span class="p">{</span><span class="ss">action: </span><span class="s2">"/posts"</span><span class="p">,</span> <span class="ss">method: </span><span class="s2">"post"</span><span class="p">}</span>
  <span class="c">-# ...
</span>  <span class="nt">%textarea</span><span class="nf">#markdown_editor</span><span class="p">{</span><span class="ss">name: </span><span class="s2">"content"</span><span class="p">,</span> <span class="ss">placeholder: </span><span class="s2">"Contenido"</span><span class="p">}</span>

<span class="nt">%link</span><span class="p">{</span><span class="ss">rel: </span><span class="s2">"stylesheet"</span><span class="p">,</span> <span class="ss">href: </span><span class="s2">"https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.css"</span><span class="p">}</span>
<span class="nt">%script</span><span class="p">{</span><span class="ss">src: </span><span class="s2">"https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.js"</span><span class="p">}</span>
<span class="nd">:javascript
</span>  <span class="c1">// La típica función para peticiones AJAX</span>
  <span class="kd">function</span> <span class="nx">AjaxRequest</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">method</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">xmlhttp</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">XMLHttpRequest</span><span class="p">)</span>
      <span class="nx">xmlhttp</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
    <span class="k">else</span>
      <span class="nx">xmlhttp</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ActiveXObject</span><span class="p">(</span><span class="dl">"</span><span class="s2">Microsoft.XMLHTTP</span><span class="dl">"</span><span class="p">);</span>

    <span class="nx">xmlhttp</span><span class="p">.</span><span class="nx">onreadystatechange</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">xmlhttp</span><span class="p">.</span><span class="nx">readyState</span> <span class="o">==</span> <span class="mi">4</span> <span class="o">&amp;&amp;</span> <span class="nx">xmlhttp</span><span class="p">.</span><span class="nx">status</span> <span class="o">==</span> <span class="mi">200</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">xmlhttp</span><span class="p">.</span><span class="nx">responseXML</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">callback</span><span class="p">(</span><span class="nx">xmlhttp</span><span class="p">.</span><span class="nx">responseXML</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="nx">callback</span><span class="p">(</span><span class="nx">xmlhttp</span><span class="p">.</span><span class="nx">responseText</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">};</span>

    <span class="nx">xmlhttp</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="nx">method</span><span class="p">,</span> <span class="nx">url</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">method</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">)</span>
      <span class="nx">xmlhttp</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Content-type</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">application/x-www-form-urlencoded</span><span class="dl">"</span><span class="p">);</span>

    <span class="nx">xmlhttp</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="c1">// Inicializa el editor Markdown con algunas opciones extra</span>
  <span class="kd">var</span> <span class="nx">simplemde</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SimpleMDE</span><span class="p">({</span>
    <span class="na">element</span><span class="p">:</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">markdown_editor</span><span class="dl">"</span><span class="p">),</span>
    <span class="na">blockStyles</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">code</span><span class="p">:</span> <span class="dl">"</span><span class="s2">~~~</span><span class="dl">"</span>
    <span class="p">},</span>
    <span class="c1">// Usa el sistema propio para vista previa (kramdown + rouge)</span>
    <span class="na">previewRender</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">plainText</span><span class="p">,</span> <span class="nx">preview</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// Esperar un segundo sin cambios para hacer la petición</span>
      <span class="k">if</span> <span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">delay</span><span class="p">)</span>
        <span class="nx">clearTimeout</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">delay</span><span class="p">);</span>

      <span class="nb">window</span><span class="p">.</span><span class="nx">delay</span> <span class="o">=</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">AjaxRequest</span><span class="p">(</span><span class="dl">"</span><span class="s2">/preview</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">content=</span><span class="dl">"</span> <span class="o">+</span> <span class="nb">encodeURIComponent</span><span class="p">(</span><span class="nx">plainText</span><span class="p">),</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
          <span class="c1">// `preview` es el nodo que contiene la vista previa</span>
          <span class="nx">preview</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">response</span><span class="p">;</span>
        <span class="p">});</span>
      <span class="p">},</span> <span class="mi">1000</span><span class="p">);</span>

      <span class="k">return</span> <span class="nx">preview</span><span class="p">.</span><span class="nx">innerHTML</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">});</span>
</code></pre></div></div>

<p>Ahora sí, con todo esto tenemos un editor que facilita la tarea de escribir un post a cualquiera.</p>

<h2 id="los-extras">Los extras</h2>

<p>Un par de funcionalidades adicionales que hemos utilizado en <a href="http://tux.ugr.es/dgiim/new/post">el formulario para LibreIM</a> son la inclusión de <a href="http://mathjax.org/">MathJax</a> para interpretar fórmulas en LaTeX, y de un CAPTCHA mediante la gema <a href="https://rubygems.org/gems/recaptcha/">recaptcha</a>. No entro aquí en más detalle porque son fáciles de usar; además, todo nuestro código está <a href="https://github.com/libreim/form-im">publicado en GitHub</a>.</p>

<h2 id="en-conclusión">En conclusión…</h2>

<p>Mantener un blog en Jekyll tiene muchas ventajas: se puede hostear en cualquier servidor ya que es un generador de sitios estáticos, se puede realizar control de cambios por Git, etc. Y, con un poco de trabajo y una pequeña aplicación web, también se puede hacer accesible la colaboración a cualquier persona, incluso sin conocimientos de GitHub, Jekyll o Markdown. Ahora queda la parte complicada: convencer a más personas para que contribuyan al blog ;)</p>

  </article>

  <article>
    <a href="/research/2016/09/01/deep-learning/"><h1>Unsupervised Deep learning</h1></a>
    <p>Deep learning is a branch of machine learning dedicated to algorithms which find abstractions or partial representations of data through multiple layers of neurons or other complex structures. Unsupervised Deep Learning studies neural architectures which learn from data without requiring labels.</p>

<p>Published works:</p>

<ul>
  <li><em>A practical tutorial on autoencoders for nonlinear feature fusion: Taxonomy, models, software and guidelines</em>. D. Charte, F. Charte, S. García, M J. del Jesus, F. Herrera. (Information Fusion, 2018) <a href="https://www.sciencedirect.com/science/article/pii/S1566253517307844">ScienceDirect</a>, <a href="https://arxiv.org/abs/1801.01586">arXiv</a></li>
</ul>

<p>Developed software:</p>

<ul>
  <li><a href="http://ruta.software/">Ruta</a>, an early-stage R package for training unsupervised deep learning techniques such as autoencoders</li>
  <li><a href="http://github.com/fdavidcl/rutavis">Rutavis</a>, a companion package for visualizations</li>
</ul>

  </article>

  <article>
    <a href="/blog/2017/01/28/aproximadores-ruby/"><h1>Métodos de aproximación en Ruby</h1></a>
    <p>Entre las tareas de una práctica para la asignatura de Mecánica
Celeste (todo
el
<a href="https://github.com/fdavidcl/celeste">código disponible en GitHub</a>),
he tenido que programar un par de métodos numéricos de aproximación
iterativos. Resultó ser una aplicación muy práctica de los
<a href="http://tux.ugr.es/libreim/blog/2015/08/24/ruby-enumerators/">enumerables de Ruby</a> y
me parece un buen ejemplo del ahorro de código que puede suponer su uso.</p>

<p>Para abstraer distintos métodos iterativos de aproximación, definí una
clase abstracta <code class="language-plaintext highlighter-rouge">Approximator</code> de la que derivarían el resto. Permite
almacenar la aproximación actual y la tolerancia o error que se quiera
aceptar. Las clases derivadas implementan el método <code class="language-plaintext highlighter-rouge">next_one</code> que
calcula la siguiente aproximación a partir de la actual.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Clase base para métodos numéricos de aproximación de funciones</span>
<span class="k">class</span> <span class="nc">Approximator</span>

  <span class="c1"># Datos miembro</span>
  <span class="c1">#  - current:   valor de la aproximación actual</span>
  <span class="c1">#  - tolerance: valor de tolerancia</span>
  <span class="nb">attr_accessor</span> <span class="ss">:current</span><span class="p">,</span> <span class="ss">:tolerance</span>
  
  <span class="k">def</span> <span class="nf">initialize</span> <span class="n">initial</span><span class="p">,</span> <span class="n">tolerance</span> <span class="o">=</span> <span class="no">DEFAULT_TOLERANCE</span>
    <span class="nb">self</span><span class="p">.</span><span class="nf">current</span> <span class="o">=</span> <span class="n">initial</span>
    <span class="nb">self</span><span class="p">.</span><span class="nf">tolerance</span> <span class="o">=</span> <span class="n">tolerance</span>
  <span class="k">end</span>

  <span class="c1"># Método a implementar en las clases hijas</span>
  <span class="k">def</span> <span class="nf">next_one</span>
    <span class="k">raise</span> <span class="no">NotImplementedError</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>El punto clave para aprovechar la potencia de los enumeradores es
implementar un método <code class="language-plaintext highlighter-rouge">each</code> que haga uso de la función <code class="language-plaintext highlighter-rouge">yield</code> para
proporcionar los resultados parciales. En este caso, proporciona la
aproximación encontrada en cada iteración. Lo interesante de <code class="language-plaintext highlighter-rouge">yield</code>
es que no devuelve el control al método hasta que se necesita un nuevo
resultado, de forma que sólo se realizan los cálculos necesarios. Por
ejemplo, podría haber implementado (y lo hice, al principio) el método
<code class="language-plaintext highlighter-rouge">each</code> como un <code class="language-plaintext highlighter-rouge">loop</code> infinito, sin condición de parada, y podría
iterar las veces necesarias para obtener una precisión arbitraria
(suponiendo convergencia del método). Sin embargo, para poder hacer un
uso práctico de las clases, añadí la condición de parada con la
tolerancia.</p>

<p>Una vez implementado <code class="language-plaintext highlighter-rouge">each</code>, basta con incluir el módulo <code class="language-plaintext highlighter-rouge">Enumerable</code>
que añade toda la funcionalidad de los enumeradores, como <code class="language-plaintext highlighter-rouge">to_a</code> que
acumula en un array todos los elementos devueltos por <code class="language-plaintext highlighter-rouge">each</code>. Así,
para calcular la mejor aproximación basta con devolver el último
elemento de ese array.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Approximator</span>
  <span class="c1"># Método que calcula y proporciona aproximaciones</span>
  <span class="k">def</span> <span class="nf">each</span>
    <span class="n">previous</span> <span class="o">=</span> <span class="no">Float</span><span class="o">::</span><span class="no">INFINITY</span>
    <span class="k">until</span> <span class="p">(</span><span class="n">current</span> <span class="o">-</span> <span class="n">previous</span><span class="p">).</span><span class="nf">abs</span> <span class="o">&lt;</span> <span class="n">tolerance</span>
      <span class="c1"># Proporciona una aproximación y espera a que se</span>
      <span class="c1"># pida la siguiente</span>
      <span class="k">yield</span> <span class="n">current</span>
      <span class="n">previous</span> <span class="o">=</span> <span class="n">current</span>
      <span class="nb">self</span><span class="p">.</span><span class="nf">current</span> <span class="o">=</span> <span class="n">next_one</span>
    <span class="k">end</span>
  <span class="k">end</span>

  <span class="c1"># Incluimos herramientas que permiten enumerar</span>
  <span class="c1"># las aproximaciones</span>
  <span class="kp">include</span> <span class="no">Enumerable</span>

  <span class="c1"># Método que devuelve la última aproximación</span>
  <span class="c1"># para la tolerancia dada</span>
  <span class="k">def</span> <span class="nf">approximate</span>
    <span class="nb">to_a</span><span class="p">.</span><span class="nf">last</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>Además de consultar la mejor aproximación, podremos realizar otras
tareas como obtener una lista de <em>n</em> iteraciones con <code class="language-plaintext highlighter-rouge">take(n)</code>.</p>

<p>Por último, basta implementar especializaciones de esta clase con
métodos de aproximación concretos. El siguiente es el método de
Newton-Raphson, que permite calcular raíces de funciones a partir de
sucesivas evaluaciones en la función y en su derivada.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">NewtonRaphson</span> <span class="o">&lt;</span> <span class="no">Approximator</span>
  <span class="c1"># Datos miembro</span>
  <span class="c1">#  - function:   almacena la función f</span>
  <span class="c1">#  - derivative: almacena la derivada de f</span>
  <span class="nb">attr_accessor</span> <span class="ss">:function</span><span class="p">,</span> <span class="ss">:derivative</span>
  
  <span class="k">def</span> <span class="nf">initialize</span> <span class="n">initial</span><span class="p">,</span> <span class="n">tolerance</span> <span class="o">=</span> <span class="no">DEFAULT_TOLERANCE</span><span class="p">,</span> <span class="n">function</span><span class="p">,</span> <span class="n">derivative</span>
    <span class="k">super</span><span class="p">(</span><span class="n">initial</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">)</span>
    <span class="nb">self</span><span class="p">.</span><span class="nf">function</span> <span class="o">=</span> <span class="n">function</span>
    <span class="nb">self</span><span class="p">.</span><span class="nf">derivative</span> <span class="o">=</span> <span class="n">derivative</span>
  <span class="k">end</span>
  
  <span class="k">def</span> <span class="nf">next_one</span>
    <span class="c1"># Método de Newton-Raphson para encontrar raíces:</span>
    <span class="c1"># Calcula Φ(current) = current - f(current)/f'(current)</span>
    <span class="n">current</span> <span class="o">-</span> <span class="n">function</span><span class="p">.</span><span class="nf">call</span><span class="p">(</span><span class="n">current</span><span class="p">)</span><span class="o">/</span><span class="n">derivative</span><span class="p">.</span><span class="nf">call</span><span class="p">(</span><span class="n">current</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>Un ejemplo de uso de esta implementación sería el cálculo de la raíz
cuadrada de 5, como la raíz del polinomio correspondiente:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">example</span> <span class="o">=</span> <span class="no">NewtonRaphson</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span>
  <span class="mf">3.0</span><span class="p">,</span>
  <span class="o">-&gt;</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">{</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">5</span> <span class="p">},</span>
  <span class="o">-&gt;</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">{</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="p">}</span>
<span class="p">)</span>
<span class="n">example</span><span class="p">.</span><span class="nf">approximate</span>
<span class="c1">#=&gt; 2.23606797749979</span>
</code></pre></div></div>

<p>Otra especialización es la aproximación de la suma de una serie
convergente, a partir de una función que evalúe el n-ésimo término:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">SeriesApproximator</span> <span class="o">&lt;</span> <span class="no">Approximator</span>

  <span class="c1"># Datos miembro</span>
  <span class="c1">#  - term: función que evalúa el término n-ésimo de la serie</span>
  <span class="c1">#  - n: índice del término actual se la serie</span>
  <span class="nb">attr_accessor</span> <span class="ss">:term</span><span class="p">,</span> <span class="ss">:n</span>
  
  <span class="k">def</span> <span class="nf">initialize</span> <span class="n">tolerance</span> <span class="o">=</span> <span class="no">DEFAULT_TOLERANCE</span><span class="p">,</span> <span class="n">term</span>
    <span class="k">super</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">)</span>
    <span class="nb">self</span><span class="p">.</span><span class="nf">term</span> <span class="o">=</span> <span class="n">term</span>
    <span class="nb">self</span><span class="p">.</span><span class="nf">n</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">end</span>

  <span class="c1"># Calcula el siguiente término de la serie y lo suma a</span>
  <span class="c1"># la aproximación actual</span>
  <span class="k">def</span> <span class="nf">next_one</span>
    <span class="nb">self</span><span class="p">.</span><span class="nf">n</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="nb">self</span><span class="p">.</span><span class="nf">current</span> <span class="o">+=</span> <span class="n">term</span><span class="p">.</span><span class="nf">call</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>Podemos usarla para calcular la suma de Σ1/2^n:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">series</span> <span class="o">=</span> <span class="no">SeriesApproximator</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="p">{</span> <span class="mf">1.0</span><span class="o">/</span><span class="mi">2</span><span class="o">**</span><span class="n">n</span> <span class="p">})</span>
<span class="n">series</span><span class="p">.</span><span class="nf">approximate</span>
<span class="c1">#=&gt; 0.999999999998181</span>
</code></pre></div></div>

<p>En particular, las sumas de series nos pueden permitir aproximar los
valores de algunas funciones en diversos puntos, utilizando
por ejemplo <a href="https://en.wikipedia.org/wiki/Fourier_series">desarrollos de Fourier</a>.</p>

<p>Y si habéis leído hasta aquí, ¡gracias! Espero que os haya parecido útil
y os sirva para aprovechar los enumerables en otros proyectos.</p>

  </article>

  <article>
    <a href="/blog/2017/03/05/sincronizar-org/"><h1>Sincronizando notas entre PC y móvil mediante Orgzly y Syncthing</h1></a>
    <p>Uno de los sistemas más versátiles que existen para organización personal y gestión de tareas es <em>org-mode</em> de Emacs, un modo de este editor que proporciona comodidades útiles tanto para tomar notas rápidas como incluso <a href="https://m42.github.io/blog/2016/09/26/matematicas-en-emacs/">escribir unos apuntes con fórmulas matemáticas</a>. Esencialmente, aunque cuesta trabajo empezar a usarlo, tiene más utilidades y plugins que la mayoría de <a href="https://www.amazon.com/Wenger-16999-Swiss-Knife-Giant/product-reviews/B001DZTJRQ/ref=cm_cr_arp_d_viewopt_rvwer?pageNumber=1&amp;filterByStar=positive&amp;reviewerType=all_reviews">navajas suizas</a>, por lo que no es muy difícil encontrar una forma cómoda de aprovechar unas cuantas para organizarse.</p>

<p>Para llevar un sistema basado en <em>org</em> en el móvil existe <a href="http://www.orgzly.com/">Orgzly</a>, una aplicación de Android que da una interfaz intuitiva mediante botones y gestos, pero que internamente utiliza el formato de <em>org</em>.</p>

<p class="fig medium"><img src="/assets/images/orgzly.png" alt="" />
Orgzly en funcionamiento</p>

<p>La pregunta que nos vendría a la mente a todos sería si podemos tener el mismo archivo de <em>org</em> sincronizado entre nuestros dispositivos con Emacs y Orgzly. El problema al que llegamos es que el único sistema de sincronización que ofrece Orgzly es a través de Dropbox y, aparte de las preocupaciones por seguridad y privacidad que nos podrían surgir, en realidad es totalmente innecesario tener nuestro archivo almacenado en la nube.</p>

<p>La solución que he encontrado es usar <a href="https://syncthing.net/">Syncthing, un sistema de sincronización P2P de código libre</a>. Para ello simplemente tendremos que instalar la app de Syncthing en los dispositivos Android y la versión del programa correspondiente a nuestro sistema operativo para el PC.</p>

<p class="note">En Arch Linux basta ejecutar <code class="language-plaintext highlighter-rouge">pacman -S syncthing</code>. Además, conviene añadirlo al arranque del sistema con <code class="language-plaintext highlighter-rouge">systemctl --user enable syncthing</code>.</p>

<p>En la versión de PC, Syncthing generalmente inicializará una carpeta por defecto. Podemos mover ahí nuestro archivo <em>org</em>. Para hacer que se comuniquen los dispositivos entre sí, desde la interfaz web disponible en <code class="language-plaintext highlighter-rouge">localhost:8384</code> mostramos el ID desde <em>Options</em> → <em>Show ID</em> y escaneamos el código QR desde el móvil en la pantalla de <em>Nuevo dispositivo</em>.</p>

<p class="fig medium"><img src="/assets/images/syncthing-add.jpg" alt="" /></p>

<p>Una vez hecho esto, la app avisará de que el PC quiere comenzar a sincronizar la carpeta por defecto. Aceptamos la solicitud y asignamos una ruta dentro de los archivos del teléfono, para almacenar esa carpeta. Syncthing descargará en esa ubicación los archivos que hayamos copiado en el ordenador, y los volverá a enviar a este cuando realicemos cambios.</p>

<p class="fig medium"><img src="/assets/images/syncthing-pc.png" alt="" /></p>

<p>El último paso es configurar a Orgzly para que lea y escriba de esa carpeta. Para esto entramos en la configuración de la aplicación, y bajo <em>Sync</em> seleccionamos <em>Repositories</em> → <em>Directory</em>. Escogemos la ruta que definimos antes para el almacenamiento de Syncthing. A partir de ahora, Orgzly guardará en ese directorio los archivos <em>org</em> que cree, y leerá los nuevos archivos que aparezcan.</p>

<p class="fig medium"><img src="/assets/images/orgzly-repos.jpg" alt="" /></p>

<p>Por último, Syncthing permite sincronizar datos entre muchos dispositivos y ser relativamente selectivo en cuanto a qué se sincroniza con cada uno. Así, nuestros archivos de <em>org</em> pueden estar siempre actualizados vayamos donde vayamos, y sin necesidad de almacenarlos permanentemente en servidores externos.</p>


  </article>

  <article>
    <a href="/blog/2017/05/05/emacs-lazy/"><h1>Emacs for lazy people</h1></a>
    <p>Emacs is one of the most powerful, extensible editors out there.
However, learning to use it is not an easy task, and I’m just really
lazy. The following are some packages that I hope will make your life
way easier. And if you already use Emacs, I encourage you to try them
and see if they help you get a more comfortable development environment.</p>

<p>To add any of these packages to your Emacs configuration, find your 
initialization file (usually <code class="language-plaintext highlighter-rouge">~/.emacs</code> or <code class="language-plaintext highlighter-rouge">~/.emacs.d/init.el</code>) and
add the snippets there. You will also need to install and enable <code class="language-plaintext highlighter-rouge">use-package</code> 
beforehand (<a href="http://www.lunaryorn.com/posts/my-emacs-configuration-with-use-package.html">why?</a>).</p>

<h2 id="smex">Smex</h2>

<p>In Emacs we use M-x
(<kbd>Alt</kbd>+<kbd>X</kbd>) to enter any
command without the need for a dedicated keyboard shortcut or menu
entry. By default Emacs doesn’t help much while writing a command, and
it can be challenging to remember many of them, as well as tedious
writing the long ones (<code class="language-plaintext highlighter-rouge">package-list-packages</code> anyone?).
<a href="https://github.com/nonsequitur/smex/">Smex</a> is a M-x enhancement for
Emacs, built on top of Ido, which means it will try to predict and
autocomplete commands as you write them.</p>

<p>In order to install and enable Smex, add the following code to your
initialization file:</p>

<div class="language-common_lisp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="nb">use-package</span> <span class="nv">smex</span>
<span class="ss">:config</span> <span class="p">(</span><span class="nv">smex-initialize</span><span class="p">))</span>
</code></pre></div></div>

<h2 id="ergoemacs">Ergoemacs</h2>

<p>If you’re just starting to use emacs, you may find it difficult to learn
all the new keybindings. If you’re a long-time user, you may have
experienced repetitive strain injury (RSI), also known as <a href="https://en.wikipedia.org/wiki/Emacs#Emacs_pinky">Emacs
pinky</a>. Don’t worry,
I’ve got just the solution for you:
<a href="https://ergoemacs.github.io/index.html">ergoemacs-mode</a> is a minor-mode
that sets ergonomic and well-known keybindings for common editing
functions, with the aim of reducing RSI as well as adding some
familiarity to the use of emacs.</p>

<p>Just as before, add the following code to your initialization file and
restart Emacs to use it:</p>

<div class="language-common_lisp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="nb">use-package</span> <span class="nv">ergoemacs-mode</span>
<span class="ss">:init</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">ergoemacs-theme</span> <span class="no">nil</span><span class="p">)</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">ergoemacs-keyboard-layout</span> <span class="s">"es"</span><span class="p">)</span>
<span class="ss">:config</span>
  <span class="p">(</span><span class="nv">ergoemacs-mode</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div></div>

<p>You can check <a href="https://ergoemacs.github.io/key-setup.html">your new keybinding
layout</a>. Remember that,
after enabling Ergoemacs, the keyboard shortcut that allows you to enter
a custom command becomes
<kbd>Alt</kbd>+<kbd>A</kbd>.</p>

<h2 id="which-key">Which-key</h2>

<p><img src="/assets/images/emacs-which-key.png" alt="" /></p>

<p><a href="https://github.com/justbur/emacs-which-key">Which-key</a> displays the key
bindings following your currently entered incomplete command. That way,
when you can’t remember which key to press, you’ll have a cheat sheet in
a couple of seconds.</p>

<div class="language-common_lisp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="nb">use-package</span> <span class="nv">which-key</span>
<span class="ss">:config</span> <span class="p">(</span><span class="nv">which-key-mode</span><span class="p">))</span>
</code></pre></div></div>

<h2 id="auto-reload-stuff">Auto-reload stuff</h2>

<p>When using version control, files generally change while having them
open in the editor. If this happens, I expect my editor to refresh the
files so that I don’t write on an old version. Emacs doesn’t enable this
behavior by default, rather letting the user decide if they want to
reload files. Instead, we can set it to automatically reload files from
disk when changed via these configuration lines (source: <a href="http://pragmaticemacs.com/emacs/automatically-revert-buffers/">Pragmatic
Emacs</a>):</p>

<div class="language-common_lisp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="nv">global-auto-revert-mode</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">(</span><span class="nv">add-hook</span> <span class="ss">'dired-mode-hook</span> <span class="ss">'auto-revert-mode</span><span class="p">)</span>
</code></pre></div></div>

<p class="note">The <a href="https://magit.vc/">magit</a> plugin for version control with git does
refresh the files without the need for this configuration (thanks <a href="https://ncordon.github.io/">Nacho</a>
for the remark!).</p>

<h2 id="still-want-more">Still want more?</h2>

<p>These are the main tools that have eased my way into Emacs. You can check out the rest of my configuration in <a href="https://github.com/fdavidcl/dotfiles/tree/master/emacs">my dotfiles repository</a>.</p>

  </article>

  <article>
    <a href="/blog/2017/11/30/time-tracking-org/"><h1>Time tracking in Emacs with org-clock</h1></a>
    <p>This is yet another short post about a little feature in Emacs that turned out to be pretty useful. If you ever feel that you’d like to know how much time you are spending working on different projects (and are an Emacs user), this is the post for you.</p>

<h2 id="org-clock">org-clock</h2>

<p>After searching for a simple app to track my time for an hour or so, I ended up looking for that functionality in Emacs and, <a href="https://www.xkcd.com/378/">unsurprisingly enough</a>, it exists. It’s integrated inside <em>org-mode</em> so it works very well with any task list you may already have, or you could create a completely separate file exclusive for time tracking.</p>

<p>The following is the skeleton for my time log:</p>

<pre><code class="language-org">#+title: Time log

=CHEATSHEET=
- S-c         open this window (i3)
- C-c C-x C-i org-clock-in
- C-c C-x C-o org-clock-out
- C-c C-x C-j org-clock-goto
- C-c C-x C-d org-clock-display
- C-c C-x C-r org-clock-report

* Work
* M.Sc.
* Projects / Fun
</code></pre>

<p>Easy enough, the only actual content of the file is that last stack of headers (it could be a list with <code class="language-plaintext highlighter-rouge">-</code> instead of <code class="language-plaintext highlighter-rouge">*</code> as well). Now onto the good part: place the cursor over one of the tasks and type <kbd>Ctrl + c</kbd>,<kbd>Ctrl + x</kbd>,<kbd>Ctrl + i</kbd>. This will set a clock under that task with the starting time of the task. Let some time pass, and use <kbd>Ctrl + c</kbd>,<kbd>Ctrl + x</kbd>,<kbd>Ctrl + o</kbd> to stop the clock. Emacs will also remember when you have a clock running, and will warn you if you try to close the buffer or stop the clock if you start another one.</p>

<p>When you have tracked several time periods for the same task, you can compute the total time with <kbd>Ctrl + c</kbd>,<kbd>Ctrl + x</kbd>,<kbd>Ctrl + d</kbd>. <em>org-clock</em> also understands nested tasks (second-level headers, nested lists, etc.) and will sum the time of all the tasks inside a higher-level task to compute the overall spent time. You can generate a daily report with <kbd>Ctrl + c</kbd>,<kbd>Ctrl + x</kbd>,<kbd>Ctrl + r</kbd> and setting the <code class="language-plaintext highlighter-rouge">:block today</code> parameter. The following screenshot shows all these features at work:</p>

<p><img src="/assets/images/emacs-org-clock.png" alt="Screenshot of my time log" /></p>

<h2 id="convenient-stuff">Convenient stuff</h2>

<p>As a user of i3, it’s easy to set keybindings that will let me access my time log instantly:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># .config/i3/config</span>
bindsym <span class="nv">$mod</span>+c <span class="nb">exec</span> <span class="s2">"xdotool search --name 'timelog.org' windowactivate &amp;&amp; i3-msg kill || emacsclient -c /media/datos/Documents/timelog.org"</span>
for_window <span class="o">[</span><span class="nv">class</span><span class="o">=</span><span class="s2">"Emacs"</span> <span class="nv">title</span><span class="o">=</span><span class="s2">"timelog.org"</span><span class="o">]</span> floating <span class="nb">enable
</span>for_window <span class="o">[</span><span class="nv">class</span><span class="o">=</span><span class="s2">"Emacs"</span> <span class="nv">title</span><span class="o">=</span><span class="s2">"timelog.org"</span><span class="o">]</span> resize <span class="nb">set </span>1920 1280
for_window <span class="o">[</span><span class="nv">class</span><span class="o">=</span><span class="s2">"Emacs"</span> <span class="nv">title</span><span class="o">=</span><span class="s2">"timelog.org"</span><span class="o">]</span> move position center
</code></pre></div></div>

<p>This enables a <kbd>Super + c</kbd> binding that will toggle an Emacs window with the time log file.</p>

<p>In order to save some keystrokes and prevent forgetting to save the time log, I have also added these hooks into my Emacs config:</p>

<div class="language-lisp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="nv">add-hook</span> <span class="ss">'org-clock-in-hook</span> <span class="ss">'save-buffer</span><span class="p">)</span>
<span class="p">(</span><span class="nv">add-hook</span> <span class="ss">'org-clock-out-hook</span> <span class="ss">'save-buffer</span><span class="p">)</span>
</code></pre></div></div>

<p>Finally, I let Emacs open the file in background at startup with the following line in the configuration, so the buffer isn’t actually closed when I close the window:</p>

<div class="language-lisp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="nv">find-file-noselect</span> <span class="s">"~/Documentos/timelog.org"</span><span class="p">)</span>
</code></pre></div></div>

<p>And that’s all there is to simple time tracking in Emacs. I hope you learned something useful and I didn’t waste your time.</p>

  </article>

  <article>
    <a href="/blog/2018/03/10/mastodon-digitalocean/"><h1>Deploying Mastodon on a single DigitalOcean droplet</h1></a>
    <h2 id="what-happened">What happened</h2>
<p>I bought a super cheap domain with a <a href="https://quotient.space">cool name</a>. I had to put something there, so why not Mastodon? I had a 10$ coupon from DigitalOcean so I could try it for free for a month or two.</p>

<h2 id="prerequisites">Prerequisites</h2>

<p>You’ll need a domain name for this. There are free domains available in certain TLDs, and also very cheap ones out there (quotient.space was just 0.55€ for the first year).</p>

<h2 id="how-to-do-the-thing">How to do the thing</h2>

<p>Most of this process is just following Mastodon’s own <a href="https://github.com/tootsuite/documentation/blob/master/Running-Mastodon/Docker-Guide.md">Docker guide</a>. I used version 2.3.0 for this, so the process may be different for other versions.</p>

<p><strong>Disclaimer</strong>:  This is my first time deploying Mastodon so trust your own common sense over these steps.</p>

<ol>
  <li>Set up a single 5$ droplet in your DO account (if you are not yet an user you can use this link to get 10$ credit: <a href="https://m.do.co/c/ca70d8a84d85">https://m.do.co/c/ca70d8a84d85</a>). Throw your public SSH key in there and use its IP address to login: <code class="language-plaintext highlighter-rouge">ssh root@[ip-address]</code>. You can also set up your domain so that it points to DO’s nameservers and redirects to your droplet.</li>
  <li><code class="language-plaintext highlighter-rouge">apt install docker.io nginx letsencrypt</code></li>
  <li>
    <p>You’ll need a new version of docker-compose so run this (<a href="https://gist.github.com/wdullaer/f1af16bd7e970389bad3">source</a>):</p>

    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nv">COMPOSE_VERSION</span><span class="o">=</span><span class="sb">`</span>git ls-remote https://github.com/docker/compose | <span class="nb">grep </span>refs/tags | <span class="nb">grep</span> <span class="nt">-oP</span> <span class="s2">"[0-9]+</span><span class="se">\.</span><span class="s2">[0-9][0-9]+</span><span class="se">\.</span><span class="s2">[0-9]+$"</span> | <span class="nb">tail</span> <span class="nt">-n</span> 1<span class="sb">`</span>
 <span class="nb">sudo </span>sh <span class="nt">-c</span> <span class="s2">"curl -L https://github.com/docker/compose/releases/download/</span><span class="k">${</span><span class="nv">COMPOSE_VERSION</span><span class="k">}</span><span class="s2">/docker-compose-</span><span class="sb">`</span><span class="nb">uname</span> <span class="nt">-s</span><span class="sb">`</span><span class="s2">-</span><span class="sb">`</span><span class="nb">uname</span> <span class="nt">-m</span><span class="sb">`</span><span class="s2"> &gt; /usr/local/bin/docker-compose"</span>
 <span class="nb">sudo chmod</span> +x /usr/local/bin/docker-compose
 <span class="nb">sudo </span>sh <span class="nt">-c</span> <span class="s2">"curl -L https://raw.githubusercontent.com/docker/compose/</span><span class="k">${</span><span class="nv">COMPOSE_VERSION</span><span class="k">}</span><span class="s2">/contrib/completion/bash/docker-compose &gt; /etc/bash_completion.d/docker-compose"</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Also, create a swapfile:</p>

    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code> fallocate <span class="nt">-l</span> 1G /swapfile
 <span class="nb">chmod </span>600 /swapfile
 mkswap /swapfile
 swapon /swapfile
</code></pre></div>    </div>
  </li>
  <li>Follow the guide for Docker in Mastodon documentation to clone the repository. Now, <code class="language-plaintext highlighter-rouge">touch .env.production</code> since docker-compose will not work without it. Follow the guide to get the images.</li>
  <li>
    <p>Check that file permissions are correct. I came across a couple of <code class="language-plaintext highlighter-rouge">Permission denied</code> errors since some directories in the Docker container were owned by <code class="language-plaintext highlighter-rouge">root</code> instead of <code class="language-plaintext highlighter-rouge">mastodon</code>. To check this, login into the web container as root:</p>

    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code> docker-compose run <span class="nt">--rm</span> <span class="nt">-u</span> 0 web bash
 <span class="c"># in the container:</span>
 <span class="nb">chmod</span> <span class="nt">-R</span> mastodon:mastodon /mastodon/public/
</code></pre></div>    </div>

    <blockquote>
      <p>Is this terrible? Shouldn’t I have changed it? Tell me</p>
    </blockquote>
  </li>
  <li>Follow the guide to setup your instance. You don’t need a MailGun account if it’s a single-user instance, but put some fake user and password just in case. The compilation of assets may take several minutes, for convenience make sure you aren’t kicked out of the ssh session. Set up an admin account for yourself.</li>
  <li><code class="language-plaintext highlighter-rouge">docker-compose up -d</code></li>
  <li>Follow the nginx and Let’s Encrypt sections of the <a href="https://github.com/tootsuite/documentation/blob/master/Running-Mastodon/Production-guide.md#nginx-configuration">production guide</a>.</li>
  <li>If all went well you should be able to see your new Mastodon instance when you visit your domain.</li>
</ol>

<h2 id="useful-stuff">Useful stuff</h2>

<p>If assets compilation didn’t work, you can try again with</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker-compose run <span class="nt">--rm</span> web rake assets:precompile
</code></pre></div></div>

<p>If creating the user didn’t work, try adding a new user, locating the password reset token in the logs (then navigating to <code class="language-plaintext highlighter-rouge">example.com/auth/password/edit?reset_password_token=[your-token]</code> to create a password) and lastly confirming the email address:</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker-compose run <span class="nt">--rm</span> web rake mastodon:add_user
docker logs mastodon_web_1
docker-compose run <span class="nt">--rm</span> web rake mastodon:confirm_email <span class="nv">USER_EMAIL</span><span class="o">=[</span>your-email]
</code></pre></div></div>

  </article>

  <article>
    <a href="/blog/2018/03/17/ruby-10/"><h1>A guide to Ruby in ten lines of code</h1></a>
    <p>This is a slightly unorthodox introduction guide to the Ruby language. Through this guide we will examine just ten one-line snippets of code, and discover a lot of features from each of them.</p>

<p>This is the post version of a talk I gave for <a href="https://libreim.github.io">LibreIM</a>.</p>

<h2 id="syntax">Syntax</h2>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">puts</span> <span class="s2">"Hello </span><span class="si">#{</span><span class="nb">gets</span><span class="p">.</span><span class="nf">strip</span><span class="si">}</span><span class="s2">!"</span>
</code></pre></div></div>

<p>This snippet accepts a string from standard input, then cleans the leading and trailing spacing characters and embeds it in a greeting which is shown on standard output. Notice that:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">puts</code> and <code class="language-plaintext highlighter-rouge">gets</code> are the standard functions for displaying messages and reading input, respectively.</li>
  <li>You can omit parenthesis around parameters for better readability.</li>
  <li><code class="language-plaintext highlighter-rouge">#{...}</code> in strings interprets small pieces of code and transforms the output into a string.</li>
</ul>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">puts</span> <span class="s2">"boooored"</span><span class="p">.</span><span class="nf">upcase</span> <span class="k">unless</span> <span class="no">Time</span><span class="p">.</span><span class="nf">now</span><span class="p">.</span><span class="nf">saturday?</span>
</code></pre></div></div>

<p>This example is so readable you probably don’t need a description. Notice that:</p>
<ul>
  <li>Literals are Ruby objects and can receive methods.</li>
  <li><code class="language-plaintext highlighter-rouge">if</code>, <code class="language-plaintext highlighter-rouge">unless</code>, <code class="language-plaintext highlighter-rouge">while</code> and <code class="language-plaintext highlighter-rouge">until</code> can be used as one-line structures.</li>
  <li>There is a convention to end methods which return booleans with <code class="language-plaintext highlighter-rouge">?</code> and methods which have non-explicit side effects with <code class="language-plaintext highlighter-rouge">!</code>.</li>
</ul>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">real</span><span class="p">,</span> <span class="n">imag</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">3</span><span class="n">i</span><span class="p">).</span><span class="nf">rectangular</span>
</code></pre></div></div>

<p>This snippet assigns the real part of 1 + 3i to <code class="language-plaintext highlighter-rouge">real</code> and the imaginary part to <code class="language-plaintext highlighter-rouge">imag</code>. Notice that:</p>
<ul>
  <li>Ruby has built-in support for complex numbers, big numbers (as in symbolic, bigger than <code class="language-plaintext highlighter-rouge">long long</code> numbers) and symbolic rationals.</li>
  <li>Assignment allows splatting arrays. The splat operator <code class="language-plaintext highlighter-rouge">*</code> allows for related operations. For example,
    <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">xs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
</code></pre></div>    </div>
    <p>performs some Haskell-ish pattern matching: <code class="language-plaintext highlighter-rouge">x</code> receives the first element and <code class="language-plaintext highlighter-rouge">xs</code> holds the rest of the array. There is also a similar double-splat <code class="language-plaintext highlighter-rouge">**</code> for hashes.</p>
  </li>
</ul>

<h2 id="object-oriented-programming">Object oriented programming</h2>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">DeadPlayerError</span> <span class="o">&lt;</span> <span class="no">StandardError</span><span class="p">;</span> <span class="k">end</span>
</code></pre></div></div>

<p>Defines a class useful to return errors (exceptions). Notice that:</p>
<ul>
  <li>Classes are defined with <code class="language-plaintext highlighter-rouge">class</code> (which is syntax sugar for <code class="language-plaintext highlighter-rouge">Class.new { ... }</code>).</li>
  <li>There is simple inheritance with <code class="language-plaintext highlighter-rouge">&lt;</code>.</li>
  <li>You can throw an error with <code class="language-plaintext highlighter-rouge">raise DeadPlayerError</code>. Ruby distinguishes errors, from which a program can recover, and other kinds of exceptions, which leave the program in an invalid state and therefore it must stop.</li>
</ul>

<pre><code class="language-{.ruby}">Point = Struct.new :x, :y, :z
</code></pre>

<p>Creates a class with getters and setters for the given attributes. Notice that:</p>
<ul>
  <li>Member attributes of a class are <strong>always</strong> private (or protected, as they are inherited). Thus, the <em>dot</em> only sends methods and doesn’t directly access attributes.</li>
  <li>Methods can be defined in a <code class="language-plaintext highlighter-rouge">do ... end</code> block. You should consider defining a class if you want to add them.</li>
  <li>New objects are created with <code class="language-plaintext highlighter-rouge">Point.new</code>.</li>
</ul>

<h2 id="iteration-and-data-structures">Iteration and data structures</h2>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">puts</span> <span class="sx">%w[such elegant wow]</span><span class="p">.</span><span class="nf">each_with_index</span><span class="p">.</span><span class="nf">map</span> <span class="p">{</span> <span class="o">|</span><span class="n">w</span><span class="p">,</span><span class="n">i</span><span class="o">|</span> <span class="s2">"</span><span class="si">#{</span><span class="n">i</span><span class="si">}</span><span class="s2">. </span><span class="si">#{</span><span class="n">w</span><span class="si">}</span><span class="s2">"</span> <span class="p">}</span>
</code></pre></div></div>

<p>Walks through the array, obtains an array of strings <em>index. element</em> and prints it on stdout. Notice that:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">%w[]</code> splits a list of words by spaces and returns an array.</li>
  <li><code class="language-plaintext highlighter-rouge">each_with_index</code> iterates giving each element and its index in the collection.</li>
  <li><code class="language-plaintext highlighter-rouge">map</code> applies a function on each element of a collection and returns the result.</li>
  <li><code class="language-plaintext highlighter-rouge">{...}</code> o <code class="language-plaintext highlighter-rouge">do ... end</code> denote <em>blocks</em>, structures of code which are passed to methods in order to be ran from them. Blocks can receive parameters between bars <code class="language-plaintext highlighter-rouge">|a, b|</code>.</li>
</ul>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dot</span> <span class="o">=</span> <span class="o">-&gt;</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">)</span> <span class="p">{</span> <span class="n">v1</span><span class="p">.</span><span class="nf">zip</span><span class="p">(</span><span class="n">v2</span><span class="p">).</span><span class="nf">reduce</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="o">|</span><span class="nb">p</span><span class="p">,</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span><span class="o">|</span> <span class="nb">p</span> <span class="o">+</span> <span class="n">n</span> <span class="o">*</span> <span class="n">m</span> <span class="p">}</span> <span class="p">}</span>
</code></pre></div></div>

<p>Computes the dot product. Example usage: <code class="language-plaintext highlighter-rouge">dot.([1, 2, 3], [-1, 0, 2])</code>. Notice that:</p>
<ul>
  <li>Lambda functions are defined with <code class="language-plaintext highlighter-rouge">-&gt;</code>. As opposed to usual functions or methods, Lambdas are objects.</li>
  <li><code class="language-plaintext highlighter-rouge">zip</code> pairs the elements of two or more arrays.</li>
  <li><code class="language-plaintext highlighter-rouge">reduce</code> accumulates results of a binary function.</li>
</ul>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fib</span> <span class="o">=</span> <span class="no">Hash</span><span class="p">.</span><span class="nf">new</span> <span class="p">{</span> <span class="o">|</span><span class="n">h</span><span class="p">,</span> <span class="n">i</span><span class="o">|</span> <span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">h</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="p">}.</span><span class="nf">update</span><span class="p">(</span><span class="mi">0</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<p>Creates a Hash which contains, for each index, the corresponding term of the Fibonacci sequence. Notice that:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">Hash</code> may receive a <em>default</em> initialization (usually <code class="language-plaintext highlighter-rouge">nil</code>). This initialization takes place whenever the user attempts to access a value which has not been assigned previously.</li>
  <li><code class="language-plaintext highlighter-rouge">Hash#update</code> assigns several values at a time.</li>
  <li>This would be equivalent to a memoized recursive version.</li>
</ul>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">solution</span><span class="p">.</span><span class="nf">neighborhood</span><span class="p">.</span><span class="nf">detect</span> <span class="p">{</span> <span class="o">|</span><span class="n">attempt</span><span class="p">,</span> <span class="n">fitness</span><span class="o">|</span> <span class="n">fitness</span> <span class="o">&gt;</span> <span class="vi">@current_fitness</span> <span class="p">}</span>
</code></pre></div></div>

<p>Assuming the <code class="language-plaintext highlighter-rouge">.neighborhood</code> returns a collection of possible solutions and their performance (fitness), this finds the first one which improves the current solution. Actual use: <a href="https://git.io/vPxQ6">https://git.io/vPxQ6</a>. Notice that:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">detect</code> receives a predicate and returns the first ellement of the collection which verifies it.</li>
  <li>If you want to get the best solution in the neighborhood instead, you can use <code class="language-plaintext highlighter-rouge">max_by</code>.</li>
  <li>There is a huge list of iteration methods available in any Ruby collection class:
<a href="https://ruby-doc.org/core-2.5.0/Enumerable.html"><code class="language-plaintext highlighter-rouge">Enumerable</code></a></li>
</ul>

<h2 id="io">I/O</h2>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">open</span><span class="p">(</span><span class="no">DATA</span><span class="p">.</span><span class="nf">read</span><span class="p">,</span> <span class="s2">"w"</span><span class="p">).</span><span class="nf">write</span> <span class="no">IO</span><span class="p">.</span><span class="nf">read</span><span class="p">(</span><span class="vg">$0</span><span class="p">).</span><span class="nf">gsub</span><span class="p">(</span><span class="sr">/^#' /</span><span class="p">,</span> <span class="s2">""</span><span class="p">)</span>
</code></pre></div></div>

<p>This snippet reads itself (as in, the own program running), uncomments lines marked with <code class="language-plaintext highlighter-rouge">#'</code> and passes the result as input to the program started by <code class="language-plaintext highlighter-rouge">Kernel#open</code>. Notice that:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">$0</code> is the name of the current program/script.</li>
  <li><code class="language-plaintext highlighter-rouge">gsub</code> performs global sustitution</li>
  <li><code class="language-plaintext highlighter-rouge">Kernel#open</code> opens read/write pipes with other processes when the “filename” looks like <code class="language-plaintext highlighter-rouge">"|program_name"</code>.</li>
</ul>

<p><em>The catch</em>  The program is hidden in the data section of the <a href="https://github.com/fdavidcl/ruby-ten-lines/blob/master/slides.rb">original script</a>:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>__END__
|pandoc <span class="nt">-t</span> beamer <span class="nt">-o</span> slides.pdf <span class="nt">--pdf-engine</span><span class="o">=</span>xelatex
</code></pre></div></div>


  </article>

  <article>
    <a href="https://www.campusmvp.es/recursos/post/como-centrar-y-distribuir-elementos-html-con-el-modulo-flexbox-de-css.aspx"><h1>Cómo centrar y distribuir elementos HTML con el módulo flexbox de CSS</h1></a>
    

  </article>

  <article>
    <a href="https://www.campusmvp.es/recursos/post/programacion-funcional-inmutabilidad-y-funciones-puras.aspx"><h1>Programación funcional: Inmutabilidad y funciones puras</h1></a>
    

  </article>

  <article>
    <a href="https://www.campusmvp.es/recursos/post/programacion-funcional-funciones-de-primera-clase-y-de-orden-superior.aspx"><h1>Programación funcional: Funciones de primera clase y de orden superior</h1></a>
    

  </article>

  <article>
    <a href="https://www.campusmvp.es/recursos/post/mezclando-colores-y-creando-efectos-fotograficos-en-css-mediante-el-uso-de-blend-modes.aspx"><h1>Mezclando colores y creando efectos fotográficos en CSS mediante el uso de blend modes</h1></a>
    

  </article>

  <article>
    <a href="https://www.campusmvp.es/recursos/post/conceptos-esenciales-sobre-compilacion-e-interpretacion.aspx"><h1>Conceptos esenciales sobre compilación e interpretación</h1></a>
    

  </article>

  <article>
    <a href="https://www.campusmvp.es/recursos/post/como-maquetar-html-con-el-sistema-grid-de-css.aspx"><h1>Cómo maquetar HTML con el sistema grid de CSS</h1></a>
    

  </article>

  <article>
    <a href="https://www.campusmvp.es/recursos/post/3-trucos-para-automatizar-tus-tareas-de-desarrollo-con-git-hooks.aspx"><h1>3 trucos para automatizar tus tareas de desarrollo con git hooks</h1></a>
    

  </article>

  <article>
    <a href="https://www.campusmvp.es/recursos/post/3-formas-de-inicializar-colecciones-java-a-la-hora-de-declararlas.aspx"><h1>3 formas de inicializar colecciones Java a la hora de declararlas</h1></a>
    

  </article>

  <article>
    <a href="https://www.campusmvp.es/recursos/post/guia-basica-para-la-personalizacion-de-la-shell-de-linux-y-mac.aspx"><h1>Guía básica para la personalización de la shell de Linux y Mac</h1></a>
    

  </article>

  <article>
    <a href="https://www.campusmvp.es/recursos/post/truco-como-resaltar-la-inicial-de-un-texto-con-css.aspx"><h1>TRUCO: Cómo resaltar la inicial de un texto con CSS</h1></a>
    

  </article>

  <article>
    <a href="https://www.campusmvp.es/recursos/post/crea-tu-propia-pagina-o-blog-gratis-con-jekyll-y-github-parte-1-primeros-pasos.aspx"><h1>Crea tu propia página o blog gratis con Jekyll y Github: Parte 1 - Primeros pasos</h1></a>
    

  </article>

  <article>
    <a href="https://www.campusmvp.es/recursos/post/crea-tu-propia-pagina-o-blog-gratis-con-jekyll-y-github-parte-2-publicando-posts.aspx"><h1>Crea tu propia página o blog gratis con Jekyll y Github: Parte 2 - Publicando posts</h1></a>
    

  </article>

  <article>
    <a href="https://www.campusmvp.es/recursos/post/crea-tu-propia-pagina-o-blog-gratis-con-jekyll-y-github-parte-3-personalizando-el-sitio.aspx"><h1>Crea tu propia página o blog gratis con Jekyll y Github: Parte 3 - Personalizando el sitio</h1></a>
    

  </article>

  <article>
    <a href="https://www.campusmvp.es/recursos/post/crea-tu-propia-pagina-o-blog-gratis-con-jekyll-y-github-parte-4-compilacion-en-la-nube-y-gestion-de-plugins.aspx"><h1>Crea tu propia página o blog gratis con Jekyll y Github: Parte 4 - Compilación en la nube y gestión de plugins</h1></a>
    

  </article>

  <article>
    <a href="https://www.campusmvp.es/recursos/post/crea-tu-propia-pagina-o-blog-gratis-con-jekyll-y-github-parte-5-video-practico.aspx"><h1>Crea tu propia página o blog gratis con Jekyll y Github: Parte 5 - Vídeo práctico</h1></a>
    

  </article>

  <article>
    <a href="/docencia/2019/09/11/ed/"><h1>Estructuras de datos 2020/2021</h1></a>
    <h2 id="material-adicional">Material adicional</h2>

<h3 id="práctica-1">Práctica 1</h3>

<p>Makefile para compilar el código y generar archivos de tiempos:</p>

<div class="language-makefile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">SHELL</span><span class="o">=</span>/bin/bash
<span class="nv">CPP</span><span class="o">=</span><span class="nf">$(</span><span class="nb">wildcard</span> <span class="k">*</span>.cpp<span class="nf">)</span>
<span class="nv">EXE</span><span class="o">=</span><span class="nf">$(</span><span class="nb">basename</span> <span class="nv">$(CPP)</span><span class="nf">)</span>
<span class="c"># Modifica aquí para ajustar el nivel de optimización (de 0 a 3):
</span><span class="nv">CPPFLAGS</span><span class="o">=</span><span class="nt">-O0</span>
<span class="nv">DAT</span><span class="o">=</span>tiempos_busqueda.dat tiempos_ej3.dat

<span class="nl">.PHONY</span><span class="o">:</span> <span class="nf">default clean tiempos</span>

<span class="nl">default</span><span class="o">:</span> <span class="nf">$(EXE)</span>

<span class="nl">clean</span><span class="o">:</span>
	<span class="nb">rm</span> <span class="nt">-f</span> <span class="nv">$(EXE)</span> <span class="nv">$(DAT)</span>

<span class="c"># Modifica aquí para cambiar los puntos de inicio, fin y los saltos:
</span><span class="nv">inicio_busq</span><span class="o">=</span>100
<span class="nv">fin_busq</span><span class="o">=</span>1000000
<span class="nv">incremento</span><span class="o">=</span>1000
<span class="nv">inicio_ej3</span><span class="o">=</span>1024
<span class="nv">fin_ej3</span><span class="o">=</span>1000000000
<span class="nv">factor</span><span class="o">=</span>2

<span class="nl">tiempos</span><span class="o">:</span> <span class="nf">$(DAT)</span>

<span class="nl">tiempos_busqueda.dat</span><span class="o">:</span> <span class="nf">busqueda_lineal</span>
	<span class="k">for</span> <span class="o">((</span> <span class="nv">i</span><span class="o">=</span><span class="nv">$(inicio_busq)</span><span class="p">;</span> i &lt; <span class="nv">$(fin_busq)</span><span class="p">;</span> i+<span class="o">=</span><span class="nv">$(incremento)</span> <span class="o">))</span><span class="p">;</span> <span class="k">do</span> <span class="se">\</span>
		<span class="nv">cmd</span><span class="o">=</span><span class="s2">"./</span><span class="nv">$&lt;</span><span class="s2"> </span><span class="nv">$$</span><span class="s2">i 10000"</span><span class="p">;</span> <span class="se">\</span>
		<span class="nb">echo</span> <span class="nt">-en</span> <span class="s2">"</span><span class="se">\r</span><span class="nv">$$</span><span class="s2">cmd"</span><span class="p">;</span> <span class="se">\</span>
		<span class="nv">$$</span>cmd <span class="o">&gt;&gt;</span> <span class="nv">$@</span><span class="p">;</span> <span class="se">\</span>
	<span class="k">done</span>

<span class="nl">tiempos_ej3.dat</span><span class="o">:</span> <span class="nf">ejercicio3</span>
	<span class="k">for</span> <span class="o">((</span> <span class="nv">i</span><span class="o">=</span><span class="nv">$(inicio_ej3)</span><span class="p">;</span> i &lt; <span class="nv">$(fin_ej3)</span><span class="p">;</span> i<span class="k">*</span><span class="o">=</span><span class="nv">$(factor)</span> <span class="o">))</span><span class="p">;</span> <span class="k">do</span> <span class="se">\</span>
		<span class="nv">cmd</span><span class="o">=</span><span class="s2">"./</span><span class="nv">$&lt;</span><span class="s2"> </span><span class="nv">$$</span><span class="s2">i 10000"</span><span class="p">;</span> <span class="se">\</span>
		<span class="nb">echo</span> <span class="nt">-en</span> <span class="s2">"</span><span class="se">\r</span><span class="nv">$$</span><span class="s2">cmd"</span><span class="p">;</span> <span class="se">\</span>
		<span class="nv">$$</span>cmd <span class="o">&gt;&gt;</span> <span class="nv">$@</span><span class="p">;</span> <span class="se">\</span>
	<span class="k">done</span>
</code></pre></div></div>

<h2 id="recursos">Recursos</h2>

<ul>
  <li><a href="https://www.bigocheatsheet.com/">Big O Cheat Sheet</a> - Chuleta con las eficiencias teóricas de las operaciones más habituales sobre distintas estructuras de datos y de algoritmos de ordenación</li>
  <li><a href="https://www.hackerrank.com/domains/data-structures">Hackerrank</a> - Plataforma de problemas de programación para practicar</li>
  <li><a href="https://aprende.olimpiada-informatica.org/algoritmia">Aprende Programación Competitiva</a> - Colección de manuales sobre eficiencia, estructuras de datos y algoritmos</li>
  <li><a href="https://drive.google.com/uc?export=download&amp;confirm=YjAe&amp;id=1mo1Y_gc3eGLg6wwNhO6UyT7YcNrhS6bB">VSCodium Portable</a> - Un editor de texto avanzado (la versión libre de VS Code) listo para ejecutar sin instalar en cualquier Linux de 64 bits, recomendable traerlo a clase en un pen drive</li>
  <li><a href="https://imgur.com/gallery/GD5gi">Sorting Algorithms (Re-)visualized</a> - Una serie de visualizaciones animadas de algoritmos de ordenación</li>
</ul>

  </article>

  <article>
    <a href="/docencia/2019/09/11/mc/"><h1>Modelos de computación 2021/2022</h1></a>
    <h2 id="material-adicional">Material adicional</h2>

<h3 id="ejemplos-de-lex">Ejemplos de Lex</h3>

<ul>
  <li><a href="https://github.com/fdavidcl/veaml/blob/master/src/veaml.lex">Un lenguaje de marcado para edición de vídeo</a></li>
  <li><a href="https://github.com/JCEntrena/Analizador-de-Lenguajes/blob/master/plantilla.l">Un clasificador de idiomas</a></li>
  <li><a href="https://github.com/mroman42/lambdaLex/blob/master/Lex/lambdalit.lex">Un compilador de cálculo lambda</a></li>
  <li><a href="https://github.com/andreshp/pl/blob/master/src/plot.l">Un lenguaje de comandos para gráficos de gnuplot</a></li>
  <li><a href="https://github.com/ncordon/C-indentator/blob/master/C-indentator.lex">Un “indentador” de código C</a></li>
  <li><a href="https://github.com/jopime/Embellecedor-de-Codigo-Lex/blob/master/plantilla.l">Un resaltador de código C</a></li>
</ul>

<h2 id="recursos">Recursos</h2>

<ul>
  <li>Para dibujar máquinas de estados/autómatas:
    <ul>
      <li><a href="https://en.wikipedia.org/wiki/DOT_(graph_description_language)">Dot, un lenguaje de descripción de grafos</a></li>
      <li><a href="http://madebyevan.com/fsm/">Finite state machine designer</a> - Herramienta para dibujar autómatas y obtener LaTeX o imágenes</li>
    </ul>
  </li>
  <li>Simulación/cálculo de modelos de computación:
    <ul>
      <li><a href="https://regexr.com/">Regexr</a> - Aplicación para aprender y testear expresiones regulares. ¡Cuidado! Acepta expresiones regulares más “expresivas” de las que veremos en clase.</li>
      <li><a href="https://turingmachinesimulator.com/">Turing Machine Simulator</a> - Una aplicación que simula una máquina de Turing programable con una sintaxis sencilla.</li>
      <li><a href="https://mroman42.github.io/mikrokosmos/">Mikrokosmos</a> - Un intérprete educacional de cálculo lambda.</li>
      <li><a href="https://statemachine.davestewart.io/">Biblioteca de autómatas para JavaScript</a></li>
    </ul>
  </li>
</ul>


  </article>

  <article>
    <a href="/blog/2020/02/11/versatile-autoencoders/"><h1>Versatile workflow for autoencoders in Keras</h1></a>
    <h2 id="architecture-definition">Architecture definition</h2>

<p>This code defines the simplest architecture: [input, encoding (2), output]</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">enc_dim</span> <span class="o">=</span> <span class="mi">2</span>

<span class="n">encoder</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">Sequential</span><span class="p">([</span>
    <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">enc_dim</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">"relu"</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">))</span>
<span class="p">])</span>
<span class="n">decoder</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">Sequential</span><span class="p">([</span>
    <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">activation</span><span class="o">=</span><span class="s">"sigmoid"</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="n">enc_dim</span><span class="p">,))</span>
<span class="p">])</span>
</code></pre></div></div>

<h2 id="definition-of-a-loss-function">Definition of a loss function</h2>

<p>Defining the loss as a function allows us much more flexibility to compute penalties from the encodings, or even other inputs (supervised autoencoders).</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">autoencoder_loss</span><span class="p">(</span><span class="n">layers</span><span class="p">):</span>
    <span class="n">inp</span><span class="p">,</span> <span class="n">enc</span><span class="p">,</span> <span class="n">out</span> <span class="o">=</span> <span class="n">layers</span>
    <span class="n">rec_loss</span> <span class="o">=</span> <span class="n">K</span><span class="p">.</span><span class="n">binary_crossentropy</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>
    <span class="c1"># compute other penalties
</span>    <span class="n">loss</span> <span class="o">=</span> <span class="n">rec_loss</span> <span class="c1"># + other penalties
</span>    <span class="k">return</span> <span class="n">loss</span>
</code></pre></div></div>

<h2 id="definition-of-the-loss-layer-and-the-model">Definition of the loss layer and the model</h2>

<p>The loss function is wrapped as the last layer of the autoencoder model and connected to the necessary inputs/outputs.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">loss_l</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Lambda</span><span class="p">(</span><span class="n">autoencoder_loss</span><span class="p">,</span> <span class="n">output_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">name</span><span class="o">=</span><span class="s">"loss"</span><span class="p">)([</span>
    <span class="n">encoder</span><span class="p">.</span><span class="nb">input</span><span class="p">,</span> <span class="n">encoder</span><span class="p">.</span><span class="n">output</span><span class="p">,</span> <span class="n">decoder</span><span class="p">(</span><span class="n">encoder</span><span class="p">(</span><span class="n">encoder</span><span class="p">.</span><span class="nb">input</span><span class="p">))</span>
<span class="p">])</span>

<span class="n">autoencoder</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">Model</span><span class="p">([</span><span class="n">encoder</span><span class="p">.</span><span class="nb">input</span><span class="p">,</span> <span class="n">target_input</span><span class="p">],</span> <span class="n">loss_l</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="compilation-of-model-with-custom-loss">Compilation of model with custom loss</h2>

<p>Since the last layer (<code class="language-plaintext highlighter-rouge">y_pred</code>) is actually the loss, our custom loss only needs to return that value.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">autoencoder</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="p">{</span><span class="s">'loss'</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">:</span> <span class="n">y_pred</span><span class="p">},</span> <span class="n">optimizer</span><span class="o">=</span><span class="s">"adam"</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="fit-model-with-dummy-target">Fit model with dummy target</h2>

<p>Keras will complain if no target is passed, so we just create some dummy targets which will not be used at all.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">hist</span> <span class="o">=</span> <span class="n">autoencoder</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">epochs</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span>
</code></pre></div></div>

  </article>

  <article>
    <a href="/blog/2020/03/31/homelabos/"><h1>Deploying HomelabOS on a Raspberry Pi 4</h1></a>
    <p>HomelabOS is a tool for deploying self-hosted services on a server. For this installation, you will need:</p>

<ul>
  <li>Raspberry Imager</li>
  <li>Latest <code class="language-plaintext highlighter-rouge">ubuntu-preinstalled-server-arm64</code> from here: https://github.com/TheRemote/Ubuntu-Server-raspi4-unofficial/releases</li>
  <li>Docker on your PC (your user should be in the <code class="language-plaintext highlighter-rouge">docker</code> group, <code class="language-plaintext highlighter-rouge">sudo usermod -a -G docker username</code>)</li>
  <li>Latest HomelabOS zip from here: https://gitlab.com/NickBusey/HomelabOS/-/tags</li>
</ul>

<h2 id="installing-ubuntu">Installing Ubuntu</h2>

<p>We will need Ubuntu 18.04 on the Raspberry. Here’s how to install it.</p>

<h3 id="fixing-firmware">Fixing firmware</h3>

<p>First, open up Raspberry Imager and flash Raspbian to your SD card. Boot up your RPi 4 and run these commands:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>apt-get update <span class="o">&amp;&amp;</span> <span class="nb">sudo </span>apt-get dist-upgrade <span class="nt">-y</span>
<span class="nb">sudo </span>rpi-update
<span class="nb">sudo </span>rpi-eeprom-update <span class="nt">-a</span>
</code></pre></div></div>

<h3 id="actually-installing-ubuntu">Actually installing Ubuntu</h3>

<p>Now, use Raspbian Imager to flash the IMG file for Ubuntu Server 18.04 to your SD card. Boot up your Raspberry and check for working SSH (default user and password are <code class="language-plaintext highlighter-rouge">ubuntu</code>, <code class="language-plaintext highlighter-rouge">ubuntu</code>). You will need to configure an SSH key if you don’t have one, so <code class="language-plaintext highlighter-rouge">ssh-keygen</code> and <code class="language-plaintext highlighter-rouge">ssh-copy-id</code> are your friends. A static IP would also be convenient, you can <a href="https://linuxize.com/post/how-to-configure-static-ip-address-on-ubuntu-18-04/">use netplan to configure it</a>, it’s easy!</p>

<h2 id="installing-homelabos">Installing HomelabOS</h2>

<p>Extract files from the downloaded ZIP <strong>on your PC</strong>. Now <code class="language-plaintext highlighter-rouge">cd</code> to the HomelabOS directory and run the following:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make logo
make config <span class="c"># answer some questions</span>
make <span class="nb">set </span>enable_miniflux <span class="nb">true</span> <span class="c"># miniflux is a feed reader</span>
make
</code></pre></div></div>

<p>This should accomplish the following steps:</p>

<ol>
  <li>Build Docker images for HomelabOS</li>
  <li>Set some configuration variables and create <code class="language-plaintext highlighter-rouge">settings/config.yml</code></li>
  <li>Enable a service, it doesn’t have to be miniflux, I chose that for testing</li>
  <li>Deploy the configured services to your Raspberry</li>
</ol>

<p>For more info and troubleshooting, see the original posts.</p>

<h1 id="sources">Sources</h1>

<ul>
  <li>Ubuntu 18.04.4 unofficial image: https://jamesachambers.com/raspberry-pi-4-ubuntu-server-desktop-18-04-3-image-unofficial/</li>
  <li>HomelabOS installation: https://nickbusey.gitlab.io/HomelabOS/setup/installation/</li>
</ul>

<p>I’ll be updating this post with more info and tips as I continue optimizing my configuration.</p>

  </article>

  <article>
    <a href="https://www.campusmvp.es/recursos/post/5-aplicaciones-practicas-inesperadas-de-la-inteligencia-artificial.aspx"><h1>5 aplicaciones prácticas inesperadas de la Inteligencia Artificial</h1></a>
    

  </article>

  <article>
    <a href="https://www.campusmvp.es/recursos/post/aplicaciones-de-inteligencia-artificial-y-machine-learning-en-pequenos-negocios.aspx"><h1>Aplicaciones de Inteligencia Artificial y Machine Learning en pequeños negocios</h1></a>
    

  </article>

  <article>
    <a href="https://www.campusmvp.es/recursos/post/reconocimiento-y-clasificacion-de-imagenes-con-deep-learning.aspx"><h1>Reconocimiento y clasificación de imágenes con Deep Learning</h1></a>
    

  </article>


<style>
.wrapper .sidebar .side-content .sections .section-posts {
  background: #ffffff;
  color: #2e3440;
  border-color: #ffffff
}
@media (min-width: 64em) {
  .wrapper .sidebar .side-content .sections .section-posts {
    margin-right: -2rem;
    padding-right: 2rem;
  }
}
</style>

        <!-- </div> -->
      <!-- </div> -->
    <!-- </div> -->
    <!-- <link href='https://fonts.googleapis.com/css?family=Source Sans Pro:300,400,400i,700|Inconsolata:400,700' rel='stylesheet' type='text/css'> -->
    <!--link href="//maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css" rel="stylesheet" /-->
    <footer>
      <!-- <p> -->
        &copy; 2022 David Charte. Shared under
        <a href="https://creativecommons.org/licenses/by-sa/4.0/">
          <i class="icon fa fa-creative-commons fa-lg"></i> BY-SA</a>.
      <!-- </p> -->
    </footer>
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fork-awesome@1.0.11/css/fork-awesome.min.css" integrity="sha256-MGU/JUq/40CFrfxjXb5pZjpoZmxiP2KuICN5ElLFNd8=" crossorigin="anonymous">
    <!--link rel="stylesheet" href="/assets/fonts/css/icons.css"-->
    <link rel="stylesheet" href="/assets/stylesheets/highlight.css">
  </body>
</html>
